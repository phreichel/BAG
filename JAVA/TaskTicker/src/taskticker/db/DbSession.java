//*****************************************************************************
package taskticker.db;
//*****************************************************************************

import java.util.List;
import org.hibernate.Session;
import taskticker.dao.WorkerDao;

//*****************************************************************************
public class DbSession {

	//=========================================================================
	private Session session;
	//=========================================================================
	
	//=========================================================================
	public DbSession(Session session) {
		this.session = session;
	}
	//=========================================================================

	//=========================================================================
	public void begin() {
		session.getTransaction().begin();
	}
	//=========================================================================
	
	//=========================================================================
	public void rollback() {
		session.getTransaction().rollback();
	}
	//=========================================================================

	//=========================================================================
	public void commit() {
		session.getTransaction().commit();
	}
	//=========================================================================
	
	//=========================================================================
	public void close() {
		session.close();
	}
	//=========================================================================

	//=========================================================================
	public void workerSave(WorkerDao worker) {		
		session.save(worker);
	}
	//=========================================================================

	//=========================================================================
	public void workerUpdate(WorkerDao worker) {		
		session.update(worker);
	}
	//=========================================================================

	//=========================================================================
	public List<WorkerDao> workerList() {
		return session
			.createQuery("from Worker", WorkerDao.class)
			.list();
	}
	//=========================================================================

	//=========================================================================
	public WorkerDao workerGet(String ident) {
		return session
			.createQuery("from Worker where ident=:ident", WorkerDao.class)
			.setParameter("ident", ident)
			.getSingleResult();
	}
	//=========================================================================
	
}
//*****************************************************************************
