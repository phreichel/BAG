//*********************************************************************************************************************
package bot.app;
//*********************************************************************************************************************

import org.eclipse.paho.client.mqttv3.*;

//*********************************************************************************************************************
public class App implements MqttCallback {

	//=================================================================================================================
	private static final String broker   = "tcp://localhost:1883";
	private static final String clientId = "Happy Home";
	//=================================================================================================================

	//=================================================================================================================
	private MqttClient client = null;
	//=================================================================================================================

	//=================================================================================================================
	private void initClient() throws Exception  {
		client = new MqttClient(broker, clientId);
		client.setCallback(this);
		client.connect();
		client.subscribe("peter");
	}
	//=================================================================================================================
	
	//=================================================================================================================
	public void run() {
		try {
			initClient();
			byte[] data = new byte[1024*100];
			for (int i=0; i<data.length; i++) {
				data[i] = (byte) 'd';
			}
			client.publish("peter", new byte[1024*100],  0, false);
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	//=================================================================================================================

	//=================================================================================================================
	public void messageArrived(String arg0, MqttMessage arg1) throws Exception {
		int id = arg1.getId();
		byte[] data = arg1.getPayload();
		System.out.println("DELIVERY ARRIVED: " + id + ", LENGTH: " + (data.length/1024) + "k");
		System.out.println(arg0);
	}
	//=================================================================================================================
	
	//=================================================================================================================
	public void deliveryComplete(IMqttDeliveryToken arg0) {
		int id = arg0.getMessageId();
		System.out.println("DELIVERY COMPLETE: " + id);
	}
	//=================================================================================================================

	//=================================================================================================================
	public void connectionLost(Throwable arg0) {
	}
	//=================================================================================================================


}
//*********************************************************************************************************************
